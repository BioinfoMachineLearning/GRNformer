INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/utilities/seed.py:48: LightningDeprecationWarning: `lightning.pytorch.utilities.seed.seed_everything` has been deprecated in v1.8.0 and will be removed in v1.10.0. Please use `lightning.lite.utilities.seed.seed_everything` instead.
  rank_zero_deprecation(
Global seed set to 123
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 119])
801
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
wandb: Currently logged in as: aghktb. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.4 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.7
wandb: Run data is saved locally in ./wandb/run-20240321_092349-e4cu4y9y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run GRNFormer_alliswell_hHep_tcn
wandb: ‚≠êÔ∏è View project at https://wandb.ai/aghktb/GRNFormerLinkPred
wandb: üöÄ View run at https://wandb.ai/aghktb/GRNFormerLinkPred/runs/e4cu4y9y
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
4052
2876
6
5
4
3
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/2
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/2
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 1
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 0
INFO:torch.distributed.distributed_c10d:Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 2 processes
----------------------------------------------------------------------------------------------------

INFO:torch.distributed.distributed_c10d:Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
INFO:wandb:multiprocessing start_methods=fork,spawn,forkserver, using: spawn
INFO:wandb:config_cb None None {'learning_rate': 0.0001, 'node_dim': 4, 'out_chan': 8, 'num_heads': 8, 'edge_dim': 1, 'encoder_layers': 6}
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 63])
/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:208: UserWarning: num_workers>0, persistent_workers=False, and strategy=ddp_spawn may result in data loading bottlenecks. Consider setting persistent_workers=True (this is a limitation of Python .spawn() and PyTorch)
  rank_zero_warn(
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 86])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:208: UserWarning: num_workers>0, persistent_workers=False, and strategy=ddp_spawn may result in data loading bottlenecks. Consider setting persistent_workers=True (this is a limitation of Python .spawn() and PyTorch)
  rank_zero_warn(
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 150])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 75])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 129])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 112])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 81])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 221])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 94])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 103])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 76])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 26])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 55])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 194])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 205])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 121])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 77])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 252])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 57])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 184])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 17])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 100])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 65])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 85])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 127])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 72])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 61])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 94])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 116])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 108])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 55])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 15])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 69])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 137])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 35])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 25])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
/home/aghktb/GRN/GRNformer/Dataset_activatinglabels_biobert.py:275: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/TensorShape.cpp:3571.)
  targ_grn_activated = activate_grn(expr_mat[i],mean.T,Target_grn,is_tf.T)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 133])
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
torch.Size([2, 139])
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
INFO:sentence_transformers.SentenceTransformer:Use pytorch device: cuda
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
tensor([[0.0000, 0.3463, 0.0000,  ..., 0.7209, 0.4195, 0.1102],
        [0.0000, 0.3490, 0.0000,  ..., 0.6959, 0.4539, 0.0000],
        [0.0000, 0.3121, 0.0000,  ..., 0.5929, 0.4096, 0.0000],
        ...,
        [1.0000, 1.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.4718,  ..., 0.3024, 0.5690, 0.4544],
        [0.0000, 0.0000, 0.2503,  ..., 0.0000, 0.0000, 0.5289]],
       dtype=torch.float64)
801
[ True False False False False False False  True False  True False False
 False False False False False  True  True  True False  True  True False
  True  True False False  True False False  True False False False False
 False  True False False False False False  True False False False False
 False False False False False  True  True  True  True  True False  True
 False  True False False  True False  True  True  True  True False False
 False False False  True  True  True  True  True False  True False False
 False False False  True  True False False  True  True  True  True False
 False False False False False False False False  True  True False  True
 False  True False  True  True False  True  True False False False False
 False False  True False False  True False  True False False  True False
  True False  True False False False False  True  True False  True False
 False False False False False False False False False False False False
 False False  True  True  True False  True False False False False False
 False False False  True  True False False False False False False  True
  True False False  True  True  True  True False False  True False False
 False False  True False False False False False  True  True  True  True
  True  True False False  True False False False False False  True False
  True False False False False  True  True False False  True False False
 False  True  True False  True False False False  True False False False
 False  True  True False False False False  True False  True  True False
  True  True False  True False  True  True  True False False False  True
  True False False  True  True False False False False False  True  True
  True False False False  True  True False False  True  True  True  True
  True False False False False  True  True False  True False False False
 False  True  True  True False False False False False False False  True
  True  True False False False False False  True  True False False False
 False False False False False False False  True False  True False False
 False False  True  True  True  True False False False  True  True False
  True False False False False False  True False False False  True False
 False False False  True  True False False False False  True False  True
  True False False  True False False False False False False  True  True
 False False False  True  True  True False  True  True  True  True  True
  True False False False  True False  True False  True False False  True
  True  True  True  True False False False  True  True False False False
 False False  True False False False  True False False False  True  True
  True False  True  True  True  True False False  True  True False False
  True  True  True  True False  True False False False  True False False
 False False False  True False False  True  True False  True False False
  True  True False False False False  True False  True False False  True
 False  True False  True False False False  True False False False False
 False False  True False False False False False  True False False  True
 False False  True False  True False False  True  True  True  True False
  True False False False  True False False False  True False False  True
  True False False False False  True False  True False  True False False
 False False False False False False False False False  True False  True
 False  True  True  True False  True False  True  True False False False
  True  True False  True  True  True False False  True False  True  True
 False False  True  True  True False  True  True False False  True  True
 False False  True False False False False  True  True  True  True False
  True  True False False False False  True False  True False False False
  True  True False False  True False  True  True False False False False
 False False False False False False False False False False False  True
 False False  True False False  True False  True False False False False
 False  True False  True  True False False  True False  True  True False
  True  True False False False False  True False False False  True False
 False False  True False False False False False  True False  True False
  True  True False False False False  True  True False False False  True
 False False False  True False False  True False False False False False
 False False False False False False  True False False False False  True
 False False False  True False False False  True False False False  True
  True  True  True False False False  True False False False  True  True
 False False  True False  True  True False  True  True  True  True False
  True False  True False  True False False False  True False  True False
  True False  True False False False False False False  True False  True
 False False  True  True False False  True  True False False  True False
  True False False  True False  True False False False]
tensor([[0.0000, 0.3463, 0.0000,  ..., 0.7209, 0.4195, 0.1102],
        [0.0000, 0.3490, 0.0000,  ..., 0.6959, 0.4539, 0.0000],
        [0.0000, 0.3121, 0.0000,  ..., 0.5929, 0.4096, 0.0000],
        ...,
        [1.0000, 1.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.4718,  ..., 0.3024, 0.5690, 0.4544],
        [0.0000, 0.0000, 0.2503,  ..., 0.0000, 0.0000, 0.5289]],
       dtype=torch.float64)
wandb: Network error (ReadTimeout), entering retry loop.
